<Window x:Class="EShellULoadSetTools.Views.UniformLoadSetsWindowView"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:vm="clr-namespace:EShellULoadSetTools.ViewModels"
        mc:Ignorable="d"
        Title="SHELL UNIFORM LOAD SET TOOLBOX"
        Height="720"
        Width="600"
        WindowStartupLocation="CenterScreen" ResizeMode="NoResize">
    <Window.Resources>
        <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter" />
        <!-- Right-aligned numeric cell style -->
        <Style x:Key="RightAlignedCellStyle" TargetType="TextBlock">
            <Setter Property="HorizontalAlignment" Value="Right" />
        </Style>

        <!-- Right-aligned header style -->
        <Style x:Key="RightAlignedHeaderStyle" TargetType="DataGridColumnHeader">
            <Setter Property="HorizontalContentAlignment" Value="Right" />
        </Style>
    </Window.Resources>

    <Grid Margin="8">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>


        <!-- Current model info -->
        <Grid Grid.Row="1" Margin="0,0,0,8">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="0.5*" />
                <ColumnDefinition Width="1.5*" />
                <ColumnDefinition Width="1*" />
                <ColumnDefinition Width="2*" />
            </Grid.ColumnDefinitions>

            <TextBlock Grid.Column="0"
                       Text="MODEL:"
                       FontWeight="Bold"
                       FontSize="12"
                       Margin="0,0,0,0" />
            <TextBlock Grid.Column="1"
                       Text="{Binding CurrentModelFileName}" Margin="8,0,0,0" />
            <TextBlock Grid.Column="2"
                       Text="MODEL UNITS:"
                       FontWeight="Bold"
                       FontSize="12"
                       Margin="8,0,0,0" Grid.ColumnSpan="2" />
            <TextBlock Grid.Column="3"
                       Text="{Binding CurrentUnitsSummary}" Margin="8,0,0,0" />
        </Grid>

        <!-- SAFE model info -->
        <Grid Grid.Row="2" Margin="0,0,0,16">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="0.5*" />
                <ColumnDefinition Width="1.5*" />
                <ColumnDefinition Width="1*" />
                <ColumnDefinition Width="2*" />
            </Grid.ColumnDefinitions>

            <TextBlock Grid.Column="0"
                       Text="SAFE MODEL:"
                       FontWeight="Bold"
                       FontSize="12" />
            <TextBlock Grid.Column="1"
                       Text="{Binding CurrentSafeModelFileName}" Margin="8,0,0,0" />
            <TextBlock Grid.Column="2"
                       Text="SAFE MODEL UNITS:"
                       FontWeight="Bold"
                       FontSize="12"
                       Margin="8,0,0,0" Grid.ColumnSpan="2" />
            <TextBlock Grid.Column="3"
                       Text="{Binding CurrentSafeUnitsSummary}" Margin="8,0,0,0" />
        </Grid>

        <!-- Main content area: TreeView on the left, DataGrid on the right -->
        <Grid Grid.Row="3">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="2*" />
                <ColumnDefinition Width="3*" />
            </Grid.ColumnDefinitions>

            <!-- TreeView panel with action buttons -->
            <Grid Grid.Column="0" Margin="0,0,8,0">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition />
                </Grid.RowDefinitions>

                <StackPanel Grid.Row="0"
                            Orientation="Horizontal"
                            HorizontalAlignment="Left"
                            Margin="0,0,0,8">
                    <Button Content="Select All"
                            Padding="8,4"
                            Margin="0,4,0,4"
                            Click="SelectAllButton_Click" HorizontalAlignment="Left" VerticalAlignment="Center" />
                    <Button Content="Clear Selection"
                            Padding="8,4"
                            Margin="8,4,8,4"
                            Click="DeselectAllButton_Click" HorizontalAlignment="Right" VerticalAlignment="Center" />
                </StackPanel>

                <!-- TreeView bound to RootNodes -->
                <TreeView Grid.Row="1"
                          ItemsSource="{Binding RootNodes}"
                          SelectedItemChanged="TreeView_SelectedItemChanged">
                    <TreeView.ItemTemplate>
                        <HierarchicalDataTemplate DataType="{x:Type vm:UniformLoadSetNodeViewModel}"
                                                  ItemsSource="{Binding Children}">
                            <StackPanel Orientation="Horizontal">
                                <CheckBox Margin="0,0,4,0"
                                          VerticalAlignment="Center"
                                          Visibility="{Binding HasRecords, Converter={StaticResource BooleanToVisibilityConverter}}"
                                          IsChecked="{Binding IsPinned, Mode=TwoWay}" />
                                <TextBlock Text="{Binding Name}" />
                            </StackPanel>
                        </HierarchicalDataTemplate>
                    </TreeView.ItemTemplate>
                </TreeView>
            </Grid>

            <!-- DataGrid showing patterns and values for the selected set -->
            <DataGrid Grid.Column="1"
                      ItemsSource="{Binding SelectedRecords}"
                      AutoGenerateColumns="False"
                      IsReadOnly="True"
                      CanUserAddRows="False"
                      CanUserDeleteRows="False"
                      HeadersVisibility="Column"
                      Margin="8,0,0,0">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="Name"
                                        Binding="{Binding ShellUniformLoadSetName}"
                                        Width="*" />
                    <DataGridTextColumn Header="Load Pattern"
                                        Binding="{Binding LoadSetLoadPattern}"
                                        Width="*" />
                    <DataGridTextColumn Header="Value"
                                        Binding="{Binding LoadPatternValue}"
                                        Width="*"
                                        ElementStyle="{StaticResource RightAlignedCellStyle}"
                                        HeaderStyle="{StaticResource RightAlignedHeaderStyle}" />
                    <DataGridTextColumn Header="Unit"
                                        Binding="{Binding Unit}"
                                        Width="*" />
                </DataGrid.Columns>
            </DataGrid>
        </Grid>

        <!-- Bottom close button -->
        <Button Grid.Row="4"
                Content="Close"
                HorizontalAlignment="Right"
                Width="80"
                Margin="0,8,0,0"
                IsCancel="True"
                Click="CloseButton_Click" />
    </Grid>
</Window>
